/*
* @ezuikit/control-time-line v1.0.6
* Copyright (c) 2026-01-01 Ezviz-OpenBiz
* Released under the MIT License.
*/
!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global="undefined"!=typeof globalThis?globalThis:global||self).TimeLine=factory()}(this,function(){"use strict";function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var hasRequiredDist$3,dist$3={};
/*
	* @ezuikit/utils-tools v2.0.1
	* tools utils
	* Copyright (c) 2025-12-02 Ezviz-OpenBiz
	* Released under the MIT License.
	*/var cjs,hasRequiredCjs,distExports$3=function(){if(hasRequiredDist$3)return dist$3;hasRequiredDist$3=1;var getQuery=function(url){var query=url.split("?")[1],obj={};if(query)for(var vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");obj[pair[0]]=decodeURIComponent(pair[1])}return obj};function parseEzopenUrl(url){var obj={};if(/^ezopen:\/\//.test(url)){if(url.includes("@")){var endIndex=url.indexOf("@"),startIndex=url.indexOf("//");obj.validateCode=url.substring(startIndex+2,endIndex),url=url.replace(obj.validateCode+"@","")}obj.protocol=url.split("//")[0],obj.search=url.split("?")[1]?"?"+url.split("?")[1]:"",obj.hostname=url.split("/")[2],obj.origin=obj.protocol+"//"+obj.hostname,obj.pathname=url.split("?")[0].replace(obj.origin,""),obj.href=url;var pathnames=obj.pathname.split("/"),lastPath=pathnames[2].split(".");return obj.deviceSerial=pathnames[1],obj.channelNo=lastPath[0],obj.type=lastPath[lastPath.length-1],"live"===obj.type&&(obj.definition=lastPath.length>2?lastPath[1]:"sd"),"rec"===obj.type&&pathnames[2]&&(obj.recType=pathnames[2].includes(".cloud.")?"cloud":""),obj.searchParams=getQuery(url),obj}return{}}var codec={h264:1,h265:2,h266:4,vp8:8,vp9:16,av1:32};function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right}var DateTime=function(){function DateTime(){}return DateTime.fillZero=function(num,len){return void 0===len&&(len=2),num.toString().padStart(len,"0")},DateTime.format=function(input,format){var date;if(_instanceof(input,Date))date=input;else{if("number"!=typeof input&&"string"!=typeof input)throw new Error("Invalid date input");date=DateTime.toDate(input+"")}for(var _step,result=format,_iterator=function(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=function(o){if(o){if("string"==typeof o)return _array_like_to_array(o,void 0);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_array_like_to_array(o,void 0):void 0}}(o))||allowArrayLike){it&&(o=it);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}([[/(yyyy|YYYY)/g,function(){return DateTime.fillZero(date.getFullYear(),4)}],[/(yy|YY)/g,function(){return DateTime.fillZero(date.getFullYear()%100,2)}],[/(MM)/g,function(){return DateTime.fillZero(date.getMonth()+1,2)}],[/(M)/g,function(){return(date.getMonth()+1).toString()}],[/(dd|DD)/g,function(){return DateTime.fillZero(date.getDate(),2)}],[/(d|D)/g,function(){return date.getDate().toString()}],[/(HH|hh)/g,function(){return DateTime.fillZero(date.getHours(),2)}],[/(H|h)/g,function(){return date.getHours().toString()}],[/(mm)/g,function(){return DateTime.fillZero(date.getMinutes(),2)}],[/(m)/g,function(){return date.getMinutes().toString()}],[/(ss|SS)/g,function(){return DateTime.fillZero(date.getSeconds(),2)}],[/(s|S)/g,function(){return date.getSeconds().toString()}],[/(fff)/g,function(){return DateTime.fillZero(date.getMilliseconds(),3)}]]);!(_step=_iterator()).done;){var _step_value=_step.value,regexp=_step_value[0],fn=_step_value[1];result=result.replace(regexp,fn)}return result},DateTime.toDate=function(str){if(_instanceof(str,Date))return str;str=(str+"").trim().replace(/\/|\./gi,"-"),/^\d{4}$/.test(str)&&(str+="-01"),/^\d{4}-\d{2}$/.test(str)&&(str+="-01");try{return/^\d{4}-\d{2}-\d{2}$/.test(str)?new Date(str+"T00:00:00"):/^\d{8}$/.test(str)?(str+="",new Date(str.slice(0,4)+"-"+str.slice(4,6)+"-"+str.slice(6,8)+"T00:00:00")):/^\d{14}$/.test(str)?(str+="",new Date(str.slice(0,4)+"-"+str.slice(4,6)+"-"+str.slice(6,8)+"T"+str.slice(8,10)+":"+str.slice(10,12)+":"+str.slice(12,14))):/^\d{13}$/.test(str)?new Date(Number(str)):/^\d{10}$/.test(str)?new Date(1e3*Number(str)):new Date(str)}catch(error){throw new Error("Invalid date string")}},DateTime.diff=function(date1,date2,type){void 0===type&&(type="second");var d1=DateTime.toDate(date1),d2=DateTime.toDate(date2);return"second"===type?Math.floor((d1.getTime()-d2.getTime())/1e3):"minute"===type?Math.floor((d1.getTime()-d2.getTime())/1e3/60):"hour"===type?Math.floor((d1.getTime()-d2.getTime())/1e3/60/60):"day"===type?Math.floor((d1.getTime()-d2.getTime())/1e3/60/60/24):Math.abs(d1.getTime()-d2.getTime())},DateTime}();return dist$3.DateTime=DateTime,dist$3.addVc=function(url,codecs){void 0===codecs&&(codecs=["h264"]);var vc=(codecs||["h264"]).reduce(function(acc,key){return key=key.toLowerCase(),acc+(codec[key]||0)},0),host=url.split("?")[0],query=url.split("?")[1];return host+"?"+(query=(query||"").split("&").filter(function(item){return!/^vc=\d?/.test(item)}).join("&"))+(query?"&":"")+"vc="+vc},dist$3.getQuery=getQuery,dist$3.getStaticPath=function(path,base){void 0===base&&(base="");var protocolReg=/^(https?:\/\/|^\/\/)/;if(""===path||void 0===path)return"";if(protocolReg.test(path))return path;path=path.replace(/\/+/g,"/"),base=protocolReg.test(base||"")?base:window.location.href;try{return new URL(path,base).href}catch(error){return path}},dist$3.isHttp=function(url){return/^http[s]?:\/\//.test(url)},dist$3.isMobile=function(agent){var _navigator,_navigator1,_navigator2,_window;return/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone|Opera Mini)/i.test(null!=agent?agent:null==(_navigator=navigator)?void 0:_navigator.userAgent)||/Macintosh/i.test(agent||(null==(_navigator1=navigator)?void 0:_navigator1.userAgent))&&(null==(_navigator2=navigator)?void 0:_navigator2.maxTouchPoints)>1||!!(null==(_window=window)?void 0:_window.__IS_MOBILE_SIMULATOR__)},dist$3.parseEzopenUrl=parseEzopenUrl,dist$3.pick=function(obj,keys){return Object.entries(obj).reduce(function(acc,param){var key=param[0],value=param[1];return keys.includes(key)&&(acc[key]=value),acc},{})},dist$3.switchEzopenUrl=function(url,options){var _ref=null!=options?options:{},type=_ref.type,recType=_ref.recType,search=_ref.search,definition=_ref.definition,channelNo=_ref.channelNo,deviceSerial=_ref.deviceSerial,validateCode=_ref.validateCode,obj=parseEzopenUrl(url);if(search){var ns=Object.assign({},obj.searchParams,getQuery("?"+search.replace("?","")));search=Object.entries(ns).reduce(function(acc,param){var key=param[0],value=param[1];return""===value?acc:acc+=key+"="+encodeURIComponent(value)+"&"},"?").replace(/&$/,"")}else search=obj.search;return type=type||obj.type,recType=null!=recType?recType:obj.recType,definition=null!=definition?definition:obj.definition,channelNo=channelNo||obj.channelNo,deviceSerial=deviceSerial||obj.deviceSerial,validateCode=null!=validateCode?validateCode:obj.validateCode,obj.protocol+"//"+(validateCode?validateCode+"@":"")+obj.hostname+"/"+deviceSerial+"/"+channelNo+("rec"===type&&recType?"."+recType:"")+("live"===type&&"hd"===definition?"."+definition:"")+"."+type+search},dist$3}();function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var isMergeableObject=function(value){return function(value){return!!value&&"object"==typeof value}(value)&&!function(value){var stringValue=Object.prototype.toString.call(value);return"[object RegExp]"===stringValue||"[object Date]"===stringValue||function(value){return value.$$typeof===REACT_ELEMENT_TYPE}(value)}(value)};var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(value,options){return!1!==options.clone&&options.isMergeableObject(value)?deepmerge((val=value,Array.isArray(val)?[]:{}),value,options):value;var val}function defaultArrayMerge(target,source,options){return target.concat(source).map(function(element){return cloneUnlessOtherwiseSpecified(element,options)})}function getKeys(target){return Object.keys(target).concat(function(target){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(target).filter(function(symbol){return Object.propertyIsEnumerable.call(target,symbol)}):[]}(target))}function propertyIsOnObject(object,property){try{return property in object}catch(_){return!1}}function mergeObject(target,source,options){var destination={};return options.isMergeableObject(target)&&getKeys(target).forEach(function(key){destination[key]=cloneUnlessOtherwiseSpecified(target[key],options)}),getKeys(source).forEach(function(key){(function(target,key){return propertyIsOnObject(target,key)&&!(Object.hasOwnProperty.call(target,key)&&Object.propertyIsEnumerable.call(target,key))})(target,key)||(propertyIsOnObject(target,key)&&options.isMergeableObject(source[key])?destination[key]=function(key,options){if(!options.customMerge)return deepmerge;var customMerge=options.customMerge(key);return"function"==typeof customMerge?customMerge:deepmerge}(key,options)(target[key],source[key],options):destination[key]=cloneUnlessOtherwiseSpecified(source[key],options))}),destination}function deepmerge(target,source,options){(options=options||{}).arrayMerge=options.arrayMerge||defaultArrayMerge,options.isMergeableObject=options.isMergeableObject||isMergeableObject,options.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var sourceIsArray=Array.isArray(source);return sourceIsArray===Array.isArray(target)?sourceIsArray?options.arrayMerge(target,source,options):mergeObject(target,source,options):cloneUnlessOtherwiseSpecified(source,options)}return deepmerge.all=function(array,options){if(!Array.isArray(array))throw new Error("first argument should be an array");return array.reduce(function(prev,next){return deepmerge(prev,next,options)},{})},cjs=deepmerge}var dist$2,hasRequiredDist$2,deepmerge=getDefaultExportFromCjs(requireCjs());var dist$1,hasRequiredDist$1,distExports$2=function(){if(hasRequiredDist$2)return dist$2;function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _create_for_of_iterator_helper_loose(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=function(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_array_like_to_array(o,minLen):void 0}}(o))||allowArrayLike){it&&(o=it);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}hasRequiredDist$2=1;var pickerProvider=function(){function PickerProvider(){this.pickers=[]}var _proto=PickerProvider.prototype;return _proto.add=function(picker){this.pickers.push(picker)},_proto.remove=function(picker){var index=this.pickers.indexOf(picker);index>-1&&this.pickers.splice(index,1)},_proto.closeOther=function(e){for(var _step,_iterator=_create_for_of_iterator_helper_loose(this.pickers);!(_step=_iterator()).done;){var _p_$container_contains,_p_$container,_p_$wrapperContent_contains,_p_$wrapperContent,p=_step.value;!p||e.target===p.$container||(null==(_p_$container=p.$container)||null==(_p_$container_contains=_p_$container.contains)?void 0:_p_$container_contains.call(_p_$container,e.target))||e.target===p.$wrapperContent||(null==(_p_$wrapperContent=p.$wrapperContent)||null==(_p_$wrapperContent_contains=_p_$wrapperContent.contains)?void 0:_p_$wrapperContent_contains.call(_p_$wrapperContent,e.target))||(p.open=!1)}},PickerProvider.getInstance=function(){return PickerProvider.instance||(PickerProvider.instance=new PickerProvider),PickerProvider.instance},PickerProvider}().getInstance();function _create_class(Constructor,protoProps,staticProps){return protoProps&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),Constructor}var _$PICKER_PLACEMENT$_=["top","tl","tr","bottom","bl","br"],__$PICKER_DEFAULT_OPTIONS$__={getPopupContainer:function(){return document.body},wrapClassName:"",open:!1,placement:"br",offset:[0,0],zIndex:1e3,content:"",trigger:"click",mouseLeaveDelay:.1,mouseEnterDelay:.1,isMobile:!1,triggerClose:!1},Picker=function(){function Picker(container,options){var _this__$popupContainer,_this__$popupContainer1;this._open=!1,this._OpenChange=!1,this._animationTimer=null,this._disabled=!1,this._timer=null,this._options=Object.assign({},__$PICKER_DEFAULT_OPTIONS$__,options||{}),this._options.isMobile&&(this._options.trigger="click"),pickerProvider.add(this),this.$container="function"==typeof container?container():container,this.$wrapperContent=document.createElement("div"),this._initContentStyle(),"function"==typeof this._options.getPopupContainer?this._$popupContainer=this._options.getPopupContainer():this._$popupContainer=document.body,["INPUT","CANVAS","VIDEO","IMG"].includes(null==(_this__$popupContainer=this._$popupContainer)?void 0:_this__$popupContainer.tagName)&&(this._$popupContainer=document.body),this._$popupContainer!==document.body&&(this._$popupContainer.style.position="relative"),null==(_this__$popupContainer1=this._$popupContainer)||_this__$popupContainer1.appendChild(this.$wrapperContent),this._onContentClick=this._onContentClick.bind(this),this._onShow=this._onShow.bind(this),this._onContainerClick=this._onContainerClick.bind(this),this._onWrapperShow=this._onWrapperShow.bind(this),this._onHide=this._onHide.bind(this),this._onDocumentClick=this._onDocumentClick.bind(this),this._eventListener(),this.open=!!this._options.open}var _proto=Picker.prototype;return _proto.setPlacement=function(placement){this._disabled||(_$PICKER_PLACEMENT$_.includes(placement)&&(this._options.placement=placement),this._setPlacement())},_proto.destroy=function(){this._animationTimerClear(),this._removeHtml(),pickerProvider.remove(this)},_proto.innerHTML=function(html){this.$body&&(this.$body.innerHTML=html||"",this._setPlacement())},_proto._onOpenChange=function(open){null==this._options.onOpenChange||this._options.onOpenChange.call(this._options,!!open)},_proto._animationTimerClear=function(){this._animationTimer&&(clearTimeout(this._animationTimer),this._animationTimer=null)},_proto._removeHtml=function(){var _this_$wrapperContent,_this_$container_removeEventListener,_this_$container,_this_$container_removeEventListener1,_this_$container1,_this_$container_removeEventListener2,_this_$container2,_this_$container_removeEventListener3,_this_$container3,_this_$container_removeEventListener4,_this_$container4,_this_$wrapperContent1,_this_$wrapperContent2;(null==(_this_$wrapperContent=this.$wrapperContent)||_this_$wrapperContent.removeEventListener("click",this._onContentClick),null==(_this_$container=this.$container)||null==(_this_$container_removeEventListener=_this_$container.removeEventListener)||_this_$container_removeEventListener.call(_this_$container,"click",this._onContentClick),"click"===this._options.trigger&&(null==(_this_$container1=this.$container)||null==(_this_$container_removeEventListener1=_this_$container1.removeEventListener)||_this_$container_removeEventListener1.call(_this_$container1,"click",this._onContainerClick)),"hover"===this._options.trigger)&&(null==(_this_$container2=this.$container)||null==(_this_$container_removeEventListener2=_this_$container2.removeEventListener)||_this_$container_removeEventListener2.call(_this_$container2,"mouseenter",this._onShow),null==(_this_$container3=this.$container)||null==(_this_$container_removeEventListener3=_this_$container3.removeEventListener)||_this_$container_removeEventListener3.call(_this_$container3,"mouseover",this._onShow),null==(_this_$container4=this.$container)||null==(_this_$container_removeEventListener4=_this_$container4.removeEventListener)||_this_$container_removeEventListener4.call(_this_$container4,"mouseleave",this._onHide),null==(_this_$wrapperContent1=this.$wrapperContent)||_this_$wrapperContent1.removeEventListener("mouseenter",this._onWrapperShow),null==(_this_$wrapperContent2=this.$wrapperContent)||_this_$wrapperContent2.removeEventListener("mouseleave",this._onHide));this._options.isMobile||(window.removeEventListener("blur",this._onHide),document.removeEventListener("visibilitychange",this._onHide),window.removeEventListener("resize",this._onHide),document.removeEventListener("click",this._onDocumentClick)),this._$mask&&(this._$mask.removeEventListener("click",this._onHide),this._$mask.remove(),this._$mask=null),this._options.isMobile&&document.body.classList.remove("epicker-body-noscroll"),this.$wrapperContent&&(this.$wrapperContent.remove(),this.$wrapperContent=null)},_proto._setPlacement=function(){var _this_$container_getBoundingClientRect,_this_$container;if(this._open&&!this._options.isMobile&&this.$container){var right,$containerRect=null==(_this_$container=this.$container)||null==(_this_$container_getBoundingClientRect=_this_$container.getBoundingClientRect)?void 0:_this_$container_getBoundingClientRect.call(_this_$container),$wrapperContentRect=this.$wrapperContent.getBoundingClientRect(),$popupContainerRect=this._$popupContainer.getBoundingClientRect(),containerLeft=Math.ceil($containerRect.left)-Math.ceil($popupContainerRect.left),containerRight=-(Math.ceil($containerRect.right)-Math.ceil($popupContainerRect.right)),containerTop=Math.ceil($containerRect.y)-Math.ceil($popupContainerRect.y),left=containerLeft+(Math.ceil($containerRect.width)-Math.ceil($wrapperContentRect.width))/2,top=containerTop-Math.ceil($wrapperContentRect.height),bottom=containerTop+Math.ceil($containerRect.height);if(/^t/.test(this._options.placement)){var _this__options_offset,_this__options_offset1,_this__options_offset2;switch(this._options.placement){case"top":right=void 0;break;case"tl":right=void 0,left=containerLeft;break;case"tr":left=void 0,right=containerRight}this.$wrapperContent.style.cssText+="\n        "+(void 0!==right?"right: "+(right+((null==(_this__options_offset=this._options.offset)?void 0:_this__options_offset[0])||0))+"px;":"")+"\n        "+(void 0!==left?"left: "+(left+((null==(_this__options_offset1=this._options.offset)?void 0:_this__options_offset1[0])||0))+"px;":"")+"\n        top: "+(top+((null==(_this__options_offset2=this._options.offset)?void 0:_this__options_offset2[1])||0))+"px;\n        z-index:"+this._options.zIndex+";\n      "}else if(/^b/.test(this._options.placement)){var _this__options_offset3,_this__options_offset4,_this__options_offset5;switch(this._options.placement){case"bottom":right=void 0;break;case"bl":right=void 0,left=containerLeft;break;case"br":left=void 0,right=containerRight}this.$wrapperContent&&(this.$wrapperContent.style.cssText+="\n          "+(void 0!==right?"right: "+(right+((null==(_this__options_offset3=this._options.offset)?void 0:_this__options_offset3[0])||0))+"px;":"")+"\n          "+(void 0!==left?"left: "+(left+((null==(_this__options_offset4=this._options.offset)?void 0:_this__options_offset4[0])||0))+"px;":"")+"\n          top: "+(bottom+((null==(_this__options_offset5=this._options.offset)?void 0:_this__options_offset5[1])||0))+"px;\n          z-index:"+this._options.zIndex+";\n        ")}}},_proto._initContentStyle=function(){if(this.$wrapperContent&&(this.$wrapperContent.classList.add("epicker","epicker-wrapper","epicker-"+this._options.placement),this.$wrapperContent.style.display="none",this._options.isMobile&&(this.$wrapperContent.classList.add("epicker-mobile"),this._$mask=document.createElement("div"),this._$mask.classList.add("epicker-mask"),this.$wrapperContent.appendChild(this._$mask)),this.$body=document.createElement("div"),this.$body.classList.add("epicker-body"),this.$wrapperContent.appendChild(this.$body),"string"==typeof this._options.content?this.innerHTML(this._options.content):"function"==typeof this._options.content&&this.innerHTML(null==this._options.content?void 0:this._options.content.call(this._options)),"string"==typeof this._options.wrapClassName))try{var _this_$wrapperContent_classList,_this_$wrapperContent;null==(_this_$wrapperContent=this.$wrapperContent)||(_this_$wrapperContent_classList=_this_$wrapperContent.classList).add.apply(_this_$wrapperContent_classList,[].concat(this._options.wrapClassName.split(" ")))}catch(_error){}},_proto._eventListener=function(){var _this_$container_addEventListener,_this_$container,_this_$container_addEventListener1,_this_$container1,_this_$container_addEventListener2,_this_$container2,_this_$container_addEventListener3,_this_$container3,_this_$container_addEventListener4,_this_$container4;(this.$wrapperContent.addEventListener("click",this._onContentClick),null==(_this_$container=this.$container)||null==(_this_$container_addEventListener=_this_$container.addEventListener)||_this_$container_addEventListener.call(_this_$container,"click",this._onContentClick),"click"===this._options.trigger&&(null==(_this_$container1=this.$container)||null==(_this_$container_addEventListener1=_this_$container1.addEventListener)||_this_$container_addEventListener1.call(_this_$container1,"click",this._onContainerClick)),"hover"===this._options.trigger)&&(null==(_this_$container2=this.$container)||null==(_this_$container_addEventListener2=_this_$container2.addEventListener)||_this_$container_addEventListener2.call(_this_$container2,"mouseenter",this._onShow),null==(_this_$container3=this.$container)||null==(_this_$container_addEventListener3=_this_$container3.addEventListener)||_this_$container_addEventListener3.call(_this_$container3,"mouseover",this._onShow),null==(_this_$container4=this.$container)||null==(_this_$container_addEventListener4=_this_$container4.addEventListener)||_this_$container_addEventListener4.call(_this_$container4,"mouseleave",this._onHide),this.$wrapperContent.addEventListener("mouseenter",this._onWrapperShow),this.$wrapperContent.addEventListener("mouseleave",this._onHide));this._$mask&&this._$mask.addEventListener("click",this._onHide),this._options.isMobile||(window.addEventListener("blur",this._onHide),document.addEventListener("visibilitychange",this._onHide),window.addEventListener("resize",this._onHide),document.addEventListener("click",this._onDocumentClick))},_proto._onContentClick=function(e){pickerProvider.closeOther(e)},_proto._onContainerClick=function(event){var _this_$wrapperContent_contains,_this_$wrapperContent;if(!this._disabled){var contain=(null==(_this_$wrapperContent=this.$wrapperContent)||null==(_this_$wrapperContent_contains=_this_$wrapperContent.contains)?void 0:_this_$wrapperContent_contains.call(_this_$wrapperContent,event.target))||this.$wrapperContent===event.target;this._options.triggerClose&&"click"===this._options.trigger&&!contain?this.open=!this.open:this.open=!0}},_proto._onShow=function(){this._disabled||(this.open=!0)},_proto._onWrapperShow=function(){this._disabled||this._onShow()},_proto._onHide=function(e){this._open&&!this._disabled&&((null==e?void 0:e.target)===this._$mask&&(null==e||e.stopPropagation()),this.open=!1)},_proto._onDocumentClick=function(event){var _this_$container;if(!this.$wrapperContent.contains(event.target)&&this.$wrapperContent!==event.target&&!(null==(_this_$container=this.$container)?void 0:_this_$container.contains(event.target))&&this.$container!==event.target){if(this._disabled)return;this._onHide()}},_create_class(Picker,[{key:"open",get:function(){return this._open},set:function(open){var _this=this;this._disabled||this._open!==!!open&&(this._animationTimerClear(),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=open?setTimeout(function(){_this.$wrapperContent&&(_this.$wrapperContent.style.display="inline-flex",_this.$wrapperContent.style.pointerEvents="",_this._options.isMobile&&document.body.classList.add("epicker-body-noscroll"),_this._animationTimer=setTimeout(function(){_this._animationTimerClear(),_this.$wrapperContent.style.opacity="1"},0),requestAnimationFrame(function(){_this._setPlacement()}),_this._OpenChange=open,_this._onOpenChange(open))},1e3*(this._options.mouseEnterDelay<0?0:this._options.mouseEnterDelay)):setTimeout(function(){_this.$wrapperContent&&(_this.$wrapperContent.style.opacity="0",_this.$wrapperContent.style.pointerEvents="none",_this._options.isMobile&&document.body.classList.remove("epicker-body-noscroll"),_this._animationTimer=setTimeout(function(){_this._animationTimerClear(),_this.$wrapperContent.style.display="none"},301),_this._OpenChange=open,_this._onOpenChange(open))},1e3*(this._options.mouseLeaveDelay<0?0:this._options.mouseLeaveDelay)),this._OpenChange===open&&this._timer&&(clearTimeout(this._timer),this._timer=null),this._open=!!open)}},{key:"disabled",get:function(){return this._disabled},set:function(disabled){var _this_$container_classList_add,_this_$container_classList,_this_$container,_this_$container_classList_remove,_this_$container_classList1,_this_$container1;disabled?null==(_this_$container=this.$container)||null==(_this_$container_classList=_this_$container.classList)||null==(_this_$container_classList_add=_this_$container_classList.add)||_this_$container_classList_add.call(_this_$container_classList,"epicker-disabled"):null==(_this_$container1=this.$container)||null==(_this_$container_classList1=_this_$container1.classList)||null==(_this_$container_classList_remove=_this_$container_classList1.remove)||_this_$container_classList_remove.call(_this_$container_classList1,"epicker-disabled");this._disabled=disabled}}]),Picker}();return Picker.VERSION="1.1.7",dist$2=Picker}(),Picker=getDefaultExportFromCjs(distExports$2);var hasRequiredDelegate,distExports$1=function(){if(hasRequiredDist$1)return dist$1;function _create_class(Constructor,protoProps,staticProps){return protoProps&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),Constructor}hasRequiredDist$1=1;var _$DRAG_SCROLL_DEFAULT_OPTIONS$_={content:"",width:"100%",height:"400px",readonly:!1,hideScrollbar:!1};return dist$1=function(){function DragScroll(container,options){if(void 0===options&&(options={}),this._indicatorTimeout=null,this._$scrollbar=null,this._$scrollbarThumb=null,this._readonly=!1,!container)throw new Error("container is required");if(["VIDEO","CANVAS","IMG","TEXTAREA","INPUT"].includes(container.tagName))throw new Error("container cannot be 'VIDEO', 'CANVAS', 'IMG', 'TEXTAREA', 'INPUT' element");this.$container=container,this.options=Object.assign({},_$DRAG_SCROLL_DEFAULT_OPTIONS$_,options),this.$container.classList.add("drag-scroll","drag-scroll-container"),this.$content=document.createElement("div"),this.$content.classList.add("drag-scroll-content"),this.innerHtml(this.options.content),this.$container.appendChild(this.$content),this.isDragging=!1,this._startY=0,this.currentY=0,this.velocity=0,this._animationId=null,this._lastTimestamp=0,this._spring=.25,this._friction=.92,this._bounceDamping=.6,this._maxVelocity=30,this.options.hideScrollbar||this._renderScrollbar(),this._onMouseDown=this._onMouseDown.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this.readonly=this.options.readonly,this._init()}var _proto=DragScroll.prototype;return _proto.resize=function(width,height){var css="";/^\d+(\.\d+)?$/.test(width+"")?css="width: "+width+"px;":"string"==typeof width&&(css="width: "+width+";"),/^\d+(\.\d+)?$/.test(height+"")?css+="height: "+height+"px;":"string"==typeof height&&(css+="height: "+height+";"),this.$container.style.cssText+=css,this._applyTransform()},_proto.innerHtml=function(html){this.$content.innerHTML="function"==typeof html?html():html,this._applyTransform()},_proto.scrollToY=function(y,triggerChange){void 0===triggerChange&&(triggerChange=!0);var maxScroll=this.$content.scrollHeight-this.$container.clientHeight;y<0||y>maxScroll||(this.currentY=y,this.velocity=0,this._applyTransform(),triggerChange&&this._updateState())},_proto.destroy=function(){var _this__$scrollbarThumb,_this__$scrollbar,_this_$content;this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=null),this._indicatorTimeout&&(clearTimeout(this._indicatorTimeout),this._indicatorTimeout=null),this.$container&&(this.$container.style.cursor="default"),null==(_this__$scrollbarThumb=this._$scrollbarThumb)||_this__$scrollbarThumb.remove(),this._$scrollbarThumb=null,null==(_this__$scrollbar=this._$scrollbar)||_this__$scrollbar.remove(),this._$scrollbar=null,null==(_this_$content=this.$content)||_this_$content.remove(),this.$content=null,this._removeEventListeners()},_proto._renderScrollbar=function(){this._$scrollbar=document.createElement("div"),this._$scrollbar.className="drag-scroll-scrollbar",this._$scrollbarThumb=document.createElement("div"),this._$scrollbarThumb.className="drag-scroll-scrollbar-thumb",this._$scrollbar.appendChild(this._$scrollbarThumb),this.$container.appendChild(this._$scrollbar)},_proto._init=function(){this.resize(this.options.width,this.options.height),this._addEventListeners(),this._updateScrollbar()},_proto._addEventListeners=function(){this.$container.addEventListener("pointerdown",this._onMouseDown),document.addEventListener("pointermove",this._onMouseMove),document.addEventListener("pointerup",this._onMouseUp),document.addEventListener("pointercancel",this._onMouseUp)},_proto._removeEventListeners=function(){this.$container.removeEventListener("touchmove",this._onTouchMove),this.$container.removeEventListener("pointerdown",this._onMouseDown),document.removeEventListener("pointermove",this._onMouseMove),document.removeEventListener("pointerup",this._onMouseUp),document.removeEventListener("pointercancel",this._onMouseUp)},_proto._onMouseDown=function(e){this.canDrag&&(this._startDrag(e.clientY),null==this.options.onDragStart||this.options.onDragStart.call(this.options,e))},_proto._onTouchMove=function(e){e.preventDefault()},_proto._startDrag=function(clientY){var _this__$scrollbar_classList,_this__$scrollbar;this.canDrag&&(this.isDragging=!0,this._startY=clientY,this.velocity=0,null==(_this__$scrollbar=this._$scrollbar)||null==(_this__$scrollbar_classList=_this__$scrollbar.classList)||_this__$scrollbar_classList.add("drag-scroll-show"),this.$container.style.cursor="grabbing")},_proto._onMouseMove=function(e){this.canDrag&&this.isDragging&&(this._drag(e.clientY),null==this.options.onDragging||this.options.onDragging.call(this.options,0,this.currentY))},_proto._drag=function(clientY){if(this.canDrag){var deltaY=this._startY-clientY;this._startY=clientY,this.currentY+=deltaY,this.velocity=deltaY,this.velocity=Math.max(Math.min(this.velocity,this._maxVelocity),-this._maxVelocity),this._applyTransform(),this._updateState()}},_proto._onMouseUp=function(e){this.canDrag&&this.isDragging&&(this.isDragging=!1,this._endDrag(),null==this.options.onDragEnd||this.options.onDragEnd.call(this.options,e))},_proto._endDrag=function(){var _this=this;this.$container.style.cursor="grab",setTimeout(function(){var _this__$scrollbar;_this.isDragging||null==(_this__$scrollbar=_this._$scrollbar)||_this__$scrollbar.classList.remove("drag-scroll-show")},1500)},_proto._applyTransform=function(){if(this.$content.offsetHeight<=this.$container.clientHeight)this.$content.style.transform="translate3d(0, 0, 0)";else{var maxScroll=this.$content.scrollHeight-this.$container.clientHeight;this.currentY<0?(this.currentY=0,this.velocity*=this._bounceDamping):this.currentY>maxScroll&&(this.currentY=maxScroll,this.velocity*=this._bounceDamping),this.$content.style.transform="translate3d(0, "+-this.currentY+"px, 0)",this._updateScrollbar()}},_proto._animate=function(timestamp){if(void 0===timestamp&&(timestamp=0),this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=null),!(this.$content.offsetHeight<=this.$container.clientHeight)){this._lastTimestamp||(this._lastTimestamp=timestamp);var deltaTime=Math.min(timestamp-this._lastTimestamp,100)/16;if(this._lastTimestamp=timestamp,!this.isDragging){this.velocity*=this._friction,this.currentY+=this.velocity;var maxScroll=this.$content.scrollHeight-this.$container.clientHeight;this.currentY<0?this.velocity-=this.currentY*this._spring*deltaTime:this.currentY>maxScroll&&(this.velocity-=(this.currentY-maxScroll)*this._spring*deltaTime),this._applyTransform(),this._updateState(),Math.abs(this.velocity)<.1&&this.currentY>=0&&this.currentY<=maxScroll&&(this.velocity=0)}}},_proto._updateScrollbar=function(){var containerHeight=this.$container.clientHeight,contentHeight=this.$content.scrollHeight,maxScroll=contentHeight-containerHeight;if(maxScroll<=0)this._$scrollbarThumb&&(this._$scrollbarThumb.style.height="0");else{var thumbHeight=Math.max(containerHeight/contentHeight*containerHeight,20),thumbPosition=this.currentY/maxScroll*(containerHeight-thumbHeight);this._$scrollbarThumb&&(this._$scrollbarThumb.style.height=thumbHeight+"px",this._$scrollbarThumb.style.transform="translateY("+thumbPosition+"px)")}},_proto._updateState=function(){null==this.options.onChange||this.options.onChange.call(this.options,{x:0,y:this.currentY,velocity:+this.velocity.toFixed(1)})},_create_class(DragScroll,[{key:"width",get:function(){return this.$container.clientWidth}},{key:"height",get:function(){return this.$container.clientHeight}},{key:"readonly",get:function(){return this._readonly},set:function(value){this._readonly!==value&&(this.$container.style.cursor=value?"not-allowed":"grab",this._readonly=value),this.$container.removeEventListener("touchmove",this._onTouchMove),value||this.$container.addEventListener("touchmove",this._onTouchMove,{passive:!1})}},{key:"canDrag",get:function(){var offsetHeight=this.$content.offsetHeight;return!this.readonly&&offsetHeight>this.$container.clientHeight}}]),DragScroll}()}(),DragScroll=getDefaultExportFromCjs(distExports$1),delegate$2={exports:{}};var hasRequiredDist,delegateExports=(hasRequiredDelegate||(hasRequiredDelegate=1,function(module){module.exports=function(){var DOCUMENT_NODE_TYPE=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=(null==proto?void 0:proto.matchesSelector)||(null==proto?void 0:proto.mozMatchesSelector)||(null==proto?void 0:proto.msMatchesSelector)||(null==proto?void 0:proto.oMatchesSelector)||(null==proto?void 0:proto.webkitMatchesSelector)}function closest(element,selector){for(;element&&element.nodeType!==DOCUMENT_NODE_TYPE;){if("function"==typeof element.matches&&element.matches(selector))return element;element=element.parentNode}return null}function closestNative(element,selector){return element&&element.closest(selector)}var closest$1="function"==typeof Element.prototype.closest?closestNative:closest;function _delegate(element,selector,type,callback,useCapture){var listenerFn=listener.apply(this,arguments);return element.addEventListener(type,listenerFn,useCapture),{destroy:function(){element.removeEventListener(type,listenerFn,useCapture)}}}function delegate(elements,selector,type,callback,useCapture){return"function"==typeof elements.addEventListener?_delegate.apply(null,arguments):"function"==typeof type?_delegate.bind(null,document).apply(null,arguments):("string"==typeof elements&&(elements=document.querySelectorAll(elements)),Array.prototype.map.call(elements,function(element){return _delegate(element,selector,type,callback,useCapture)}))}function listener(element,selector,type,callback){return function(e){e.delegateTarget=closest$1(e.target,selector),e.delegateTarget&&callback.call(element,e)}}return delegate}()}(delegate$2)),delegate$2.exports),delegate=getDefaultExportFromCjs(delegateExports),dist={exports:{}};var distExports=function(){if(hasRequiredDist)return dist.exports;hasRequiredDist=1;var deepmerge=requireCjs(),I18n=function(){function I18n(translations,options){this._translations={},this._locale=null==options?void 0:options.defaultLocale,translations&&(this._translations=translations,(null==options?void 0:options.defaultLocale)||(this._locale=Object.keys(translations)[0])),this.options=options||{}}var Constructor,protoProps,_proto=I18n.prototype;return _proto.t=function(scope,variables){var value,translation=this._translations[this._locale];if(!translation)return"function"==typeof this.options.customizeMissing?this.options.customizeMissing(scope,variables):'[missing "'+this._locale+'" locale]';if("string"==typeof scope&&scope.includes(".")&&!(scope in translation)){var _this__findChainValue=this._findChainValue(translation,scope),v=_this__findChainValue[0];if(_this__findChainValue[1])value=v;else{if(void 0===(null==variables?void 0:variables.defaultvalue))return"function"==typeof this.options.customizeMissing?this.options.customizeMissing(scope,variables):'[missing "'+this._locale+"."+scope+'" translation]';value=variables.defaultvalue}}else if(scope in translation)value=translation[scope];else{if(void 0===(null==variables?void 0:variables.defaultvalue))return"function"==typeof this.options.customizeMissing?this.options.customizeMissing(scope,variables):'[missing "'+this._locale+"."+scope+'" translation]';value=variables.defaultvalue}return"string"==typeof value&&variables&&/\{\{\s*(\w+)\s*\}\}/.test(value)?value.replace(/\{\{\s*(\w+)\s*\}\}/g,function(_,varName){return String(variables[varName])||""}):value},_proto.appendTranslations=function(translations){this._translations=deepmerge(this._translations,translations,{clone:!1}),this._locale||(this._locale=Object.keys(this._translations)[0]),this._onChange()},_proto.switchLocale=function(locale){locale in this._translations&&(this._locale=locale,this._onChange())},_proto.switchTranslation=function(locale){this.switchLocale(locale)},_proto.getCurrentLocale=function(){return this._locale},_proto.getCurrentTranslation=function(){return this._translations[this._locale]},_proto.getVersion=function(){return"2.0.0"},_proto._onChange=function(){return null==this.options.onChange?void 0:this.options.onChange.call(this.options,this)},_proto._findChainValue=function(obj,path){for(var paths=path.split("."),translation=obj,i=0;i<paths.length;i++){if(!(paths[i]in translation))return[void 0,!1];if(translation=translation[paths[i]],i+1===paths.length)return[translation[paths[i]],!0]}return[void 0,!1]},Constructor=I18n,(protoProps=[{key:"locale",get:function(){return this._locale}},{key:"translations",get:function(){return this._translations}}])&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),I18n}();return I18n.VERSION="2.0.0",dist.exports=I18n,dist.exports}(),I18n=getDefaultExportFromCjs(distExports),_$TIMELINE_LOCALES$_={zh:{title:"包含{{len}}段录像",foldTitle:"{{len}}个录像"},en:{title:"Includes {{len}} {{unit}}",foldTitle:"{{len}} {{unit}}"}};function _create_class$2(Constructor,protoProps,staticProps){return protoProps&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),Constructor}var _$BASE_TIME_LINE_DEFAULT_OPTIONS$_={current:new Date,language:"zh",timeSections:[],readOnly:!1,className:"",timeWidth:0,width:"100%",timePointColor:"#1890ff",timeTextColor:"#FFF",timeScaleColor:"#FFF",timeSectionColor:"rgba(24, 144, 255, 0.5)",timeAxisBgColor:"#000",onChange:function(){},onDragStart:function(){},onDragging:function(){},onDragEnd:function(){},onDestroy:function(){}},BaseTimeLine=function(){function BaseTimeLine(container,options){if(this._current=new Date,this._readOnly=!1,this._width=0,this._height=0,this._destroyed=!1,this._timeWidth=0,this._timeSections=[],this.$container=container,!container)throw new Error("container is required");var left,right;this.options=deepmerge(_$BASE_TIME_LINE_DEFAULT_OPTIONS$_,options,{clone:!1}),this.options.timeSections&&Array.isArray(this.options.timeSections)&&(this._timeSections=this.options.timeSections),this.options.readOnly&&(this.readOnly=this.options.readOnly),this.options.className&&this.$container.classList.add(this.options.className),this.$container.style.position="relative",this.options.current&&(left=this.options.current,null!=(right=Date)&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?right[Symbol.hasInstance](left):left instanceof right)?this._current=this.options.current||new Date:this._current=new Date,this.i18n=new I18n(deepmerge(_$TIMELINE_LOCALES$_,this.options.locales||{},{clone:!1}),{defaultLocale:this.options.language||"zh"}),this._timeWidth=this.options.timeWidth||0,this._resize(this.options.width||"100%",this.options.height)}var _proto=BaseTimeLine.prototype;return _proto.setReadOnly=function(readOnly){this.readOnly=readOnly},_proto.update=function(current){this._current=current},_proto.updateTimeSections=function(timeSections){timeSections&&Array.isArray(timeSections)&&(this._timeSections=timeSections)},_proto.resize=function(width,height){this._resize(width,height)},_proto._resize=function(width,height){var cssText="";/^\d+(\.\d+)?$/.test(width+"")?cssText+="width: "+width+"px;":width&&(cssText+="width: "+width+";"),/^\d+(\.\d+)?$/.test(height+"")?cssText+="height: "+height+"px;":height&&(cssText+="height: "+height+";"),this.$container&&(this.$container.style.cssText+=cssText),this._width=Math.floor(this.$container.clientWidth),this._height=Math.floor(this.$container.clientHeight)},_proto.setTimeWidth=function(timeWidth){[0,1,2,3,4,5].includes(timeWidth)&&(this._timeWidth=timeWidth)},_proto.destroy=function(){this._current=null,null==this.options.onDestroy||this.options.onDestroy.call(this.options),this._timeSections=[],this._readOnly=!1,this._destroyed=!0},_create_class$2(BaseTimeLine,[{key:"current",get:function(){return this._current},set:function(current){this._current=current}},{key:"readOnly",get:function(){return this._readOnly},set:function(readOnly){this._readOnly!==readOnly&&(this._readOnly=readOnly,this.$container.style.cursor=readOnly?"not-allowed":"pointer")}},{key:"timeSections",get:function(){return this._timeSections}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"timeWidth",get:function(){return this._timeWidth}}]),BaseTimeLine}();BaseTimeLine.LOCALES=_$TIMELINE_LOCALES$_;var TimeLineUtil=function(){function TimeLineUtil(){}return TimeLineUtil.timeToSecond=function(time){var e=time.split(":");return 60*Number(e[0])*60+60*Number(e[1])+(Number(e[2])||0)},TimeLineUtil.minuteToTime=function(minute){var hour=Math.floor(minute/60),m=minute%60;return(hour>9?hour:"0"+hour)+":"+(m>9?m:"0"+m)},TimeLineUtil.timeToMinute=function(time){var e=time.split(":");return 60*Number(e[0])+Number(e[1])},TimeLineUtil.tranTimeToString=function(start,end){var _DateTime_toDate,_DateTime_toDate1,secondNum=Math.floor((null==(_DateTime_toDate=distExports$3.DateTime.toDate(end))?void 0:_DateTime_toDate.getTime())-(null==(_DateTime_toDate1=distExports$3.DateTime.toDate(start))?void 0:_DateTime_toDate1.getTime()))/1e3,second=secondNum%60,minute=Math.floor(secondNum/60);return(minute>0?distExports$3.DateTime.fillZero(minute)+"'":"0'")+distExports$3.DateTime.fillZero(second)+"''"},TimeLineUtil}(),_$TIMELINE_ICONS$__tip='<svg viewBox="0 0 57 24" fill="currentColor" width="1em" height="1em" focusable="false" aria-hidden="true" data-icon="tip">\n        <path class="ez-time-line-icon-tip" fill-rule="evenodd" d="m4,0l44,0c2.2091,0 4,1.7909 4,4l0,3.8218l4.9399,3.3572c0.5839,0.3968 0.5839,1.2574 0,1.6542l-4.9399,3.3572l0,3.8096c0,2.2091 -1.7909,4 -4,4l-44,0c-2.2091,0 -4,-1.7909 -4,-4l0,-16c0,-2.2091 1.7909,-4 4,-4z"/>\n  </svg>',_$TIMELINE_ICONS$__plus='\n  <svg viewBox="0 0 16 16" fill="currentColor" width="1em" height="1em" focusable="false" aria-hidden="true" data-icon="plus">\n    <path d="M0 0L10.6667 0" stroke="rgb(44,44,44)" stroke-linecap="round" stroke-width="1.5" transform="matrix(0,1,-1,0,8,2.66663)"/>\n    <path d="M2.66669 8L13.3334 8" stroke="rgb(44,44,44)" stroke-linecap="round" stroke-width="1.5"/>\n  </svg>\n  ',_$TIMELINE_ICONS$__minus='\n    <svg viewBox="0 0 16 16" fill="currentColor" width="1em" height="1em" focusable="false" aria-hidden="true" data-icon="minus">\n      <path d="M2.66669 8L13.3334 8" stroke="rgb(44,44,44)" stroke-linecap="round" stroke-width="1.5"/>\n    </svg>\n  ',_$TIMELINE_ICONS$__close='\n    <svg viewBox="0 0 24 24" fill="none" width="1em" height="1em" stroke="currentColor" focusable="false" aria-hidden="true" data-icon="close">\n\t    <path d="M0 0L15.9998 0" stroke-linecap="round" stroke-width="1.5" transform="matrix(0.707099,0.707114,-0.707114,0.707099,6.34277,6.34326)" />\n\t\t  <path d="M0 0L15.9998 0" stroke-linecap="round" stroke-width="1.5" transform="matrix(0.707099,-0.707114,0.707114,0.707099,6.34277,17.6567)" />\n    </svg>\n  ',_$TIMELINE_ICONS$__pause='<svg viewBox="0 0 20 20" fill="currentColor" width="1em" height="1em" focusable="false" aria-hidden="true" data-icon="pause">\n\t\t  <path d="M9.43914 2.47881L13.4688 8.4912C14.3594 9.81998 13.4071 11.6047 11.8074 11.6047L3.74811 11.6047C2.14849 11.6047 1.19616 9.81998 2.08675 8.4912L6.11641 2.47881C6.90863 1.2968 8.64693 1.2968 9.43914 2.47881Z" fill-rule="evenodd" transform="matrix(0,1,-1,0,16.5781,2.22229)" />\n    </svg>\n  ',_$TIMELINE_ICONS$__picture='\n    <svg viewBox="0 0 19.1613 19.4583" fill="currentColor" width="1em" height="1em" focusable="false" aria-hidden="true" data-icon="picture">\n        <path xmlns="http://www.w3.org/2000/svg" id="形状结合" d="M15.3276 2.63477L3.83173 2.63477C2.70848 2.63477 1.79541 3.55027 1.79541 4.68419L1.79541 14.7737C1.79541 15.9076 2.70848 16.8231 3.83173 16.8231L15.3276 16.8231C16.4504 16.8231 17.364 15.9074 17.364 14.7737L17.364 4.68419C17.364 3.55027 16.4509 2.63477 15.3276 2.63477ZM3.83247 3.851L15.3284 3.851C15.7936 3.851 16.1671 4.22551 16.1671 4.68429L16.1671 14.7738C16.1671 15.2323 15.7932 15.6071 15.3284 15.6071L3.83247 15.6071C3.36725 15.6071 2.99373 15.2326 2.99373 14.7738L2.99373 12.2622L6.7356 9.56381L6.78139 9.53916C6.84532 9.51493 6.91856 9.52524 6.9742 9.56947L13.2644 14.5698L13.3381 14.62C13.5918 14.7666 13.9197 14.7063 14.105 14.4658C14.3089 14.2014 14.263 13.8192 14.0026 13.6122L7.71239 8.61184L7.60526 8.5346C7.12945 8.22451 6.51026 8.23473 6.04222 8.57224L2.99373 10.7706L2.99373 4.68429C2.99373 4.22551 3.36725 3.851 3.83247 3.851ZM10.5794 7.29679C10.5794 6.06542 11.5624 5.0672 12.7749 5.0672C13.9875 5.0672 14.9705 6.06542 14.9705 7.29679C14.9705 8.52817 13.9875 9.52639 12.7749 9.52639C11.5624 9.52639 10.5794 8.52817 10.5794 7.29679ZM13.7722 7.2967C13.7722 6.73699 13.3254 6.28325 12.7742 6.28325C12.223 6.28325 11.7762 6.73699 11.7762 7.2967C11.7762 7.85642 12.223 8.31015 12.7742 8.31015C13.3254 8.31015 13.7722 7.85642 13.7722 7.2967Z" fill-rule="evenodd"/>\n    </svg>\n    ',TIME_WIDTH=[[1,10,10,"单位 1秒"],[60,20,5,"单位 1分钟"],[600,20,6,"单位 10分钟"],[3600,30,6,"单位 1小时"],[14400,40,2,"单位 4小时"],[43200,80,2,"单位 12小时"]],MOBILE_TIME_WIDTH=[[1,10,10,"单位 1分钟"],[10,20,5,"单位 10分钟"],[30,20,6,"单位 30分钟"],[60,30,6,"单位 1小时"],[120,40,2,"单位 2小时"],[240,80,2,"单位 4小时"]],__$IMAGE_LAZY_LOADER_DEFAULT_OPTIONS$__={targets:[],root:null,rootMargin:"0px",threshold:.1,loadingClass:"ez-lazy-image-loading",loadedClass:"ez-lazy-image-loaded",loadedErrorClass:"ez-lazy-image-error",onLoadError:function(){}},ImageLazyLoader=function(){function ImageLazyLoader(options){void 0===options&&(options={}),this.options=Object.assign({},__$IMAGE_LAZY_LOADER_DEFAULT_OPTIONS$__,options),this._observer=null,this._init()}var _proto=ImageLazyLoader.prototype;return _proto._init=function(){var _this=this;ImageLazyLoader.isSupported&&(this._observer=new IntersectionObserver(function(entries){entries.forEach(function(entry){var _this__observer;entry.isIntersecting&&(_this._loadImage(entry.target),null==(_this__observer=_this._observer)||_this__observer.unobserve(entry.target))})},this.options)),this.addImages(this.options.targets)},_proto._loadImage=function(img){var _img_classList,_img_classList1,_img_classList2,_this=this;if(img&&!(null==(_img_classList=img.classList)?void 0:_img_classList.contains(this.options.loadingClass))&&!(null==(_img_classList1=img.classList)?void 0:_img_classList1.contains(this.options.loadedClass))&&!(null==(_img_classList2=img.classList)?void 0:_img_classList2.contains(this.options.loadedErrorClass))&&img.hasAttribute("data-src")){var _this1=this;img.classList.add(this.options.loadingClass);var tempImg=new Image;tempImg.onload=function(){img.src=img.dataset.src,img.classList.remove(_this.options.loadingClass),img.classList.add(_this.options.loadedClass),img.dispatchEvent(new Event("lazyloaded"))},tempImg.onerror=function(e){img.classList.remove(_this.options.loadingClass),img.classList.add(_this.options.loadedErrorClass),null==_this1.options.onLoadError||_this1.options.onLoadError.call(_this1.options,img)},tempImg.src=img.dataset.src}},_proto.addImages=function(targets){var _this=this;(null==targets?void 0:targets.length)&&targets.forEach(function(target){var _this__observer;(null==target?void 0:target.hasAttribute("data-src"))&&(ImageLazyLoader.isSupported&&_this._observer?null==(_this__observer=_this._observer)||_this__observer.observe(target):_this._loadImage(target))})},_proto.destroy=function(){this._observer&&(this._observer.disconnect(),this._observer=null)},ImageLazyLoader}();function _create_class$1(Constructor,protoProps,staticProps){return protoProps&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),Constructor}function _extends$1(){return _extends$1=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends$1.apply(this,arguments)}function _set_prototype_of$1(o,p){return _set_prototype_of$1=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_set_prototype_of$1(o,p)}ImageLazyLoader.isSupported="IntersectionObserver"in window;var _$MOBILE_TIME_LINE_DEFAULT_OPTIONS$_=Object.assign({},_$BASE_TIME_LINE_DEFAULT_OPTIONS$_,{height:400,width:"100%",timeWidth:0,readOnly:!1,timePointColor:"#648FFC",timeTextColor:"#666666",timeScaleColor:"transparent",timeSectionColor:"#369FFF",timeAxisBgColor:"#BDCDFF",currentTimeBgColor:"#648FFC",currentTimeColor:"#FFFFFF",showTimeWidthBtn:!0,showCoverFold:!0}),MobileTimeLine=function(BaseTimeLine){function MobileTimeLine(container,options){var _this;return(_this=BaseTimeLine.call(this,container,deepmerge(_$MOBILE_TIME_LINE_DEFAULT_OPTIONS$_,options,{clone:!1}))||this)._isTouchStart=!1,_this._dragScroll=null,_this._moveStartX=0,_this._moveStartY=0,_this._imageLazyLoader=null,_this._imageLazyLoaderPicker=null,_this.state={start:"00:00:00",end:"24:00:00",current:null,timeArr:[],availTimeLine:[],index:0},_this._onImageError=_this._onImageError.bind(_this),_this._plusClick=_this._plusClick.bind(_this),_this._minusClick=_this._minusClick.bind(_this),_this._onPickerClose=_this._onPickerClose.bind(_this),_this._onClickItem=_this._onClickItem.bind(_this),_this._onClickCoverFold=_this._onClickCoverFold.bind(_this),_this._imageLazyLoader=new ImageLazyLoader({root:_this.$container,onLoadError:function(img){null==_this._onImageError||_this._onImageError.call(_this,img)}}),_this._render(),_this.options.timeSections&&Array.isArray(_this.options.timeSections)&&_this.updateTimeSections(_this.options.timeSections),_this}!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_set_prototype_of$1(subClass,superClass)}(MobileTimeLine,BaseTimeLine);var _proto=MobileTimeLine.prototype;return _proto.setReadOnly=function(readOnly){BaseTimeLine.prototype.setReadOnly.call(this,readOnly),this._dragScroll&&(this._dragScroll.readonly=readOnly)},_proto.setTimeWidth=function(timeWidth){MOBILE_TIME_WIDTH[timeWidth]&&(BaseTimeLine.prototype.setTimeWidth.call(this,timeWidth),this._matchTimeDot())},_proto.updateTimeSections=function(timeSections,defaultIndex){BaseTimeLine.prototype.updateTimeSections.call(this,timeSections);var list=timeSections.map(function(record){return _extends$1({},record,{startTime:distExports$3.DateTime.format(record.startTime,"HH:mm:ss"),endTime:distExports$3.DateTime.format(record.endTime,"HH:mm:ss")})});if(list.length>0){void 0===defaultIndex&&(defaultIndex=list.length-1);var current=this.state.current;this._setState({availTimeLine:list,start:list[defaultIndex].startTime,end:list[defaultIndex].endTime,current:null===current?list[defaultIndex].startTime:current}),this._matchTimeDot()}else this._setState({availTimeLine:[],current:distExports$3.DateTime.format(this.current||(new Date).getTime(),"HH:mm:ss")}),this._matchTimeDot()},_proto.update=function(time){var _this__dragScroll;time&&!(null==(_this__dragScroll=this._dragScroll)?void 0:_this__dragScroll.isDragging)&&(this._setState({current:distExports$3.DateTime.format(time,"HH:mm:ss")}),this._currentOffsetH())},_proto.destroy=function(){var _this__dragScroll;if(this._scrollTimer&&(clearInterval(this._scrollTimer),this._scrollTimer=null),this._$currentTime)try{this.$container.removeChild(this._$currentTime),this._$currentTime=null}catch(error){}if(this._$itemContainer&&this._$itemList)try{this._$itemContainer.removeChild(this._$itemList),this._$itemList=null}catch(error){}if(this._$itemContainer)try{this.$container.removeChild(this._$itemContainer),this._$itemContainer=null}catch(error){}if(this._$op)try{this.$container.removeChild(this._$op),this._$op=null}catch(error){}this._picker&&(this._picker.destroy(),this._picker=null),this._imageLazyLoader&&(this._imageLazyLoader.destroy(),this._imageLazyLoader=null),this._imageLazyLoaderPicker&&(this._imageLazyLoaderPicker.destroy(),this._imageLazyLoaderPicker=null),this._removeEventListener(),null==(_this__dragScroll=this._dragScroll)||_this__dragScroll.destroy(),this._dragScroll=null,BaseTimeLine.prototype.destroy.call(this)},_proto._setState=function(obj){var _this=this;Object.keys(obj).forEach(function(key){var _this__dragScroll,_this_timeSections_;"current"===key&&obj[key]?(_this._setCurrentDOM(obj[key]),_this.state.current===obj[key]||(null==(_this__dragScroll=_this._dragScroll)?void 0:_this__dragScroll.isDragging)||(_this.state[key]=obj[key],_this.current=new Date(distExports$3.DateTime.format((null==(_this_timeSections_=_this.timeSections[0])?void 0:_this_timeSections_.endTime)||(new Date).getTime(),"YYYY-MM-DD")+"T"+obj[key]),null==_this.options.onChange||_this.options.onChange.call(_this.options,_this.current))):_this.state[key]=obj[key]})},_proto._setCurrentDOM=function(time){this._$currentTime&&(this._$currentTime.querySelector(".ez-time-line-current-value").innerHTML=time)},_proto._matchTimeDot=function(){for(var scaleWidth=this._scaleWidth,timeArr=[],minute=TimeLineUtil.timeToMinute("24:00:00"),i=minute=Math.floor(minute/scaleWidth)*scaleWidth;i>=0;){var marginTop=0,marginBottom=0;i==minute&&(marginTop=70),0==i&&(marginBottom=this.$container.clientHeight-70);var time=TimeLineUtil.minuteToTime(i);timeArr.push({id:i,current:time,label:"a"+i,marginTop:marginTop,marginBottom:marginBottom,recArr:[],coverArr:this._filterTimeSectionsByTime(time)}),i-=scaleWidth}this._setState({timeArr:timeArr}),this._matchRecTimeDot()},_proto._matchRecTimeDot=function(){var _this_state=this.state,availTimeLine=_this_state.availTimeLine,timeArr=_this_state.timeArr,scaleWidth=this._scaleWidth,len=availTimeLine.length;if(0===len)for(var j=0;j<timeArr.length;j++)timeArr[j].recArr=[];else{for(var k=0;k<timeArr.length;k++)timeArr[k].recArr=[];for(var i=0;i<len;i++){var stAvailPercent,etAvailPercent,temp=availTimeLine[i],st=TimeLineUtil.timeToSecond(temp.startTime),et=TimeLineUtil.timeToSecond(temp.endTime),stMinute=Math.floor(st/(60*scaleWidth))*scaleWidth;stAvailPercent=(st-60*stMinute)/scaleWidth;var etMinute=Math.floor(et/(60*scaleWidth))*scaleWidth;etAvailPercent=(et-60*etMinute)/scaleWidth;for(var j1=0;j1<timeArr.length;j1++)if(timeArr[j1].id==stMinute&&timeArr[j1].id==etMinute){var height=etAvailPercent-stAvailPercent,top=60-etAvailPercent;timeArr[j1].recArr.push({height:height,top:top})}else timeArr[j1].id==stMinute?timeArr[j1].recArr.push({height:60-stAvailPercent,top:0}):timeArr[j1].id==etMinute?timeArr[j1].recArr.push({height:etAvailPercent,top:60-etAvailPercent}):timeArr[j1].id>stMinute&&timeArr[j1].id<etMinute&&timeArr[j1].recArr.push({height:60,top:0})}}this._setState({timeArr:timeArr}),this._renderDateLine()},_proto._renderDateLine=function(){var _this=this,timeArr=this.state.timeArr,container=this._$itemList;container.innerHTML="",timeArr.forEach(function(item,index){var _this__imageLazyLoader,timeItemDOM=document.createElement("div");timeItemDOM.setAttribute("class","ez-time-line-time-scale-area"),item.marginTop&&(timeItemDOM.style.cssText+="margin-top: "+item.marginTop+"px;"),item.marginBottom&&(timeItemDOM.style.cssText+="margin-bottom: "+item.marginBottom+"px;"),timeItemDOM.style.cssText+="border-right-color: "+(_this.options.timeAxisBgColor||"rgba(189, 205, 255, 1)")+";",timeItemDOM.setAttribute("data-time",item.current),timeItemDOM.setAttribute("data-index",index+""),document.createElement("div").setAttribute("class","ez-time-line-scale");var timeItemHtml="";item.coverArr.length&&_this.options.showCoverFold&&(timeItemHtml+='\n            <div class="ez-time-line-time-cover-fold '+(item.coverArr.length>1?"ez-time-line-time-cover-fold-multiple":"")+'"\n            data-start="'+item.current+'">\n              '+(item.coverArr.length>1?'<div class="ez-time-line-cover-fold-placeholder" style="color: #FFF"></div>':"")+'\n              <div class="ez-time-line-time-cover-fold-img">\n                <img data-src="'+_this._setImageScr(item.coverArr[0].coverPic)+'" class="ez-time-line-img"/>\n                <span class="ez-time-line-time-cover-fold-len">\n                '+(item.coverArr.length>1?_this.i18n.t("foldTitle",{len:item.coverArr.length,unit:"videos"}):""+distExports$3.DateTime.format(item.coverArr[0].startTime,"HH:mm"))+"\n                </span>\n                "+(1===item.coverArr.length?'<span class="ez-time-line-time-cover-fold-time">'+TimeLineUtil.tranTimeToString(item.coverArr[0].startTime,item.coverArr[0].endTime)+"</span>":"")+'\n                <span class="ez-time-line-time-cover-fold-pause">'+_$TIMELINE_ICONS$__pause+"</span>\n              </div>\n            </div>"),item.recArr.forEach(function(i){timeItemHtml+='<div class="ez-time-line-time-unavail"\n                              style="height: '+i.height+"px;background-color:"+(_this.options.timeSectionColor||"#369FFF")+"; top: "+i.top+'px">\n                        </div>'}),timeItemHtml+="<div id="+item.label+' class="ez-time-line-time-label" style="color: '+(_this.options.timeTextColor||"#666")+'">'+item.current+"</div>",timeItemDOM.innerHTML=timeItemHtml,container.appendChild(timeItemDOM),item.coverArr.length&&_this.options.showCoverFold&&(null==(_this__imageLazyLoader=_this._imageLazyLoader)||_this__imageLazyLoader.addImages(container.querySelectorAll("img.ez-time-line-img")||[]))}),this._currentOffsetH()},_proto._currentOffsetH=function(){var current=this.state.current;if(current){var _this__dragScroll,y=(86400-TimeLineUtil.timeToSecond(current)||0)/this._scaleWidth;null==(_this__dragScroll=this._dragScroll)||_this__dragScroll.scrollToY(y+60,!1)}},_proto._render=function(){var _this=this;if(this._$currentTime=document.createElement("div"),this._$currentTime.classList.add("ez-time-line-current"),this._$currentTime.innerHTML='<div class="ez-time-line-current-content" style="color: '+(this.options.currentTimeBgColor||"#648FFC")+'">\n      <span class="ez-time-line-current-tip">'+_$TIMELINE_ICONS$__tip+'</span>\n      <span class="ez-time-line-current-tip-line" style="background-color: '+(this.options.timePointColor||"#648FFC")+';"></span>\n      <div class="ez-time-line-current-value" style="color: '+(this.options.currentTimeColor||"#FFFFFF")+'">00:00:00</div>\n    </div>',this.$container.appendChild(this._$currentTime),this._$itemContainer=document.createElement("div"),this._$itemContainer.classList.add("ez-time-line-container"),this.$container.appendChild(this._$itemContainer),this._dragScroll=new DragScroll(this._$itemContainer,{hideScrollbar:!0,onChange:function(state){var result=_this._offsetYToTime(state.y);result[1]!==_this.state.current&&_this._setCurrentDOM(result[0]>=86400?"23:59:59":result[1])},onDragStart:function(e){_this._moveStartX=e.clientX,_this._moveStartY=e.clientY,null==_this.options.onDragStart||_this.options.onDragStart.call(_this.options,_this.state.current)},onDragging:function(){null==_this.options.onDragging||_this.options.onDragging.call(_this.options,_this.state.current)},onDragEnd:function(){var _this__dragScroll,result=_this._offsetYToTime(null==(_this__dragScroll=_this._dragScroll)?void 0:_this__dragScroll.currentY);result[1]!==_this.state.current&&_this._setState({current:result[0]>=86400?"23:59:59":result[1]}),null==_this.options.onDragEnd||_this.options.onDragEnd.call(_this.options,_this.state.current)}}),/\d/.test(this.options.height))this._$itemContainer.style.cssText+="height: "+this.options.height+"px";else if("string"==typeof this.options.height)this._$itemContainer.style.cssText+="height: "+this.options.height;else{var height=this.$container.clientHeight;this._$itemContainer.style.cssText+="height: "+height+"px"}this._$itemList=document.createElement("div"),this._$itemList.classList.add("ez-time-line-item"),this._dragScroll.$content.appendChild(this._$itemList),this.options.showTimeWidthBtn&&(this._$op=document.createElement("div"),this._$op.classList.add("ez-time-line-op"),this._$op.innerHTML='<span class="ez-time-line-op-wrapper"><span class="ez-time-line-icon-plus">'+_$TIMELINE_ICONS$__plus+'</span> <span class="ez-time-line-icon-minus">'+_$TIMELINE_ICONS$__minus+"</span></span>",this.$container.appendChild(this._$op)),this.options.showCoverFold&&(this._picker=new Picker(null,{isMobile:!0,wrapClassName:"ez-time-line-picker",onOpenChange:function(isOpen){var _this_options_onPickerOpenChange,_this_options;null==(_this_options=_this.options)||null==(_this_options_onPickerOpenChange=_this_options.onPickerOpenChange)||_this_options_onPickerOpenChange.call(_this_options,isOpen)}}),this._imageLazyLoaderPicker=new ImageLazyLoader({root:this._picker.$body,onLoadError:function(img){null==_this._onImageError||_this._onImageError.call(_this,img)}})),this._addEventListener()},_proto._addEventListener=function(){var _this__$op_querySelector,_this__$op_querySelector1;this.options.showTimeWidthBtn&&this._$op&&(null==(_this__$op_querySelector=this._$op.querySelector(".ez-time-line-icon-plus"))||_this__$op_querySelector.addEventListener("click",this._plusClick,!1),null==(_this__$op_querySelector1=this._$op.querySelector(".ez-time-line-icon-minus"))||_this__$op_querySelector1.addEventListener("click",this._minusClick,!1));this._matchTimeDot(),this._picker&&(this._delegatePickerClose=delegate(this._picker.$body,".ez-time-line-picker-close","click",this._onPickerClose,!1),this._delegateItemContent=delegate(this._picker.$body,".ez-time-line-picker-item-content","click",this._onClickItem,!1),this._delegateCoverFold=delegate(this._$itemList,".ez-time-line-time-cover-fold","click",this._onClickCoverFold,!1))},_proto._removeEventListener=function(){var _this__$op_querySelector,_this__$op_querySelector1,_this__picker_$body_querySelector,_this__picker_$body;this.options.showTimeWidthBtn&&this._$op&&(null==(_this__$op_querySelector=this._$op.querySelector(".ez-time-line-icon-plus"))||_this__$op_querySelector.removeEventListener("click",this._plusClick),null==(_this__$op_querySelector1=this._$op.querySelector(".ez-time-line-icon-minus"))||_this__$op_querySelector1.removeEventListener("click",this._minusClick));this._picker&&(null==(_this__picker_$body=this._picker.$body)||null==(_this__picker_$body_querySelector=_this__picker_$body.querySelector(".ez-time-line-picker-close"))||_this__picker_$body_querySelector.removeEventListener("click",this._onPickerClose),this._delegateItemContent&&(this._delegateItemContent.forEach(function(delegation){delegation.destroy()}),this._delegateItemContent=null),this._delegatePickerClose&&(this._delegatePickerClose.forEach(function(delegation){delegation.destroy()}),this._delegatePickerClose=null),this._delegateCoverFold&&(this._delegateCoverFold.forEach(function(delegation){delegation.destroy()}),this._delegateCoverFold=null))},_proto._plusClick=function(){var timeWidth=this.timeWidth+1;timeWidth>0&&timeWidth<MOBILE_TIME_WIDTH.length&&this.setTimeWidth(timeWidth)},_proto._minusClick=function(){var timeWidth=this.timeWidth-1;timeWidth>=0&&timeWidth<MOBILE_TIME_WIDTH.length&&this.setTimeWidth(Math.floor(timeWidth))},_proto._timeSectionsToGroupsByHour=function(list){var obj={};return list.forEach(function(item,index){var hour=distExports$3.DateTime.format(item.startTime,"HH");obj[+hour]?obj[+hour].push(_extends$1({},item,{_index:index})):obj[+hour]=[_extends$1({},item,{_index:index})]}),obj},_proto._filterTimeSectionsByTime=function(start){if(!start)return[];var startSecond=TimeLineUtil.timeToSecond(start+":00"),endSecond=TimeLineUtil.timeToSecond(start+":00")+60*this._scaleWidth;return this.timeSections.filter(function(item){var _$start=TimeLineUtil.timeToSecond(distExports$3.DateTime.format(item.startTime,"HH:mm:ss"));return _$start>=startSecond&&_$start<endSecond})},_proto._renderPickerContent=function(start){var _this__picker_innerHTML,_this__picker,_this__picker1,_this__picker2,_this__imageLazyLoaderPicker,_this=this,list=this._filterTimeSectionsByTime(start),hourGroups=this._timeSectionsToGroupsByHour(list);(null==(_this__picker=this._picker)||null==(_this__picker_innerHTML=_this__picker.innerHTML)||_this__picker_innerHTML.call(_this__picker,'<div class="ez-time-line-picker-container">\n        <div class="ez-time-line-picker-header">\n          <span class="ez-time-line-picker-close">'+_$TIMELINE_ICONS$__close+"</span>\n          "+this.i18n.t("title",{len:list.length,unit:list.length>1?"videos":"video"})+'\n        </div>\n        <div class="ez-time-line-picker-content">\n          <div class="ez-time-line-picker-list">\n             '+Object.keys(hourGroups).reverse().map(function(key){return'<div class="ez-time-line-picker-item">\n                  <div class="ez-time-line-picker-item-title">'+key+':00</div>\n                  <div class="ez-time-line-picker-item-list">\n                    '+hourGroups[key].reverse().map(function(item){return'<div class="ez-time-line-picker-item-content"\n                                      data-start="'+distExports$3.DateTime.format(item.startTime,"YYYYMMDDTHHmmssZ")+'"\n                                      data-end="'+distExports$3.DateTime.format(item.endTime,"YYYYMMDDTHHmmssZ")+'"\n                                      data-index="'+item._index+'">\n                                    <span class="ez-time-line-picker-item-time">'+distExports$3.DateTime.format(item.startTime,"HH:mm")+'</span>\n                                    <span class="ez-time-line-picker-item-duration">\n                                      '+TimeLineUtil.tranTimeToString(item.startTime,item.endTime)+'\n                                    </span>\n                                  <img class="ez-time-line-picker-item-cover" data-src="'+_this._setImageScr(item.coverPic)+'"/>\n                                </div>'}).join("")+"\n                  </div>\n              </div>"}).join("")+"\n          </div>\n          </div>\n        </div>\n      </div>"),null==(_this__picker1=this._picker)?void 0:_this__picker1.$body)&&(null==(_this__imageLazyLoaderPicker=this._imageLazyLoaderPicker)||_this__imageLazyLoaderPicker.addImages((null==(_this__picker2=this._picker)?void 0:_this__picker2.$body.querySelectorAll("img"))||[]))},_proto._onImageError=function(img){if(!img.hasAttribute("data-error")){var _img_parentNode,placeholder=document.createElement("div");placeholder.classList.add("ez-time-line-item-cover-placeholder"),placeholder.innerHTML=""+_$TIMELINE_ICONS$__picture,null==(_img_parentNode=img.parentNode)||_img_parentNode.appendChild(placeholder),img.setAttribute("data-error","true"),img.remove()}},_proto._onPickerClose=function(){this._picker&&(this._picker.open=!1)},_proto._onClickItem=function(e){var _e_delegateTarget_getAttribute,_e_delegateTarget,index=null==(_e_delegateTarget=e.delegateTarget)||null==(_e_delegateTarget_getAttribute=_e_delegateTarget.getAttribute)?void 0:_e_delegateTarget_getAttribute.call(_e_delegateTarget,"data-index");this._picker&&(this._picker.open=!1),null==this.options.onPickerSelect||this.options.onPickerSelect.call(this.options,this.timeSections[+index])},_proto._onClickCoverFold=function(e){var _e_delegateTarget_parentElement_getAttribute,_e_delegateTarget_parentElement,_e_delegateTarget;e.preventDefault();var time=null==(_e_delegateTarget=e.delegateTarget)||null==(_e_delegateTarget_parentElement=_e_delegateTarget.parentElement)||null==(_e_delegateTarget_parentElement_getAttribute=_e_delegateTarget_parentElement.getAttribute)?void 0:_e_delegateTarget_parentElement_getAttribute.call(_e_delegateTarget_parentElement,"data-time"),moveX=Math.abs(this._moveStartX-e.clientX),moveY=Math.abs(this._moveStartY-e.clientY);this._picker&&time&&!(moveX>=1||moveY>=1)&&(this._renderPickerContent(time),this._picker.open=!0)},_proto._setImageScr=function(src){if(src){var query="x=200&"+(this.options.coverQuery||"");return src+(src.includes("?")?"&":"?")+query}return""},_proto._offsetYToTime=function(offsetY){var _this__dragScroll,y=offsetY;offsetY<60&&(y=60,null==(_this__dragScroll=this._dragScroll)||_this__dragScroll.scrollToY(y));var second=86400-Math.floor((y-60)*this._scaleWidth);return[second,distExports$3.DateTime.fillZero(Math.floor(second/3600))+":"+distExports$3.DateTime.fillZero(Math.floor(second%3600/60))+":"+distExports$3.DateTime.fillZero(second%60)]},_create_class$1(MobileTimeLine,[{key:"_scaleWidth",get:function(){return(MOBILE_TIME_WIDTH[this.timeWidth]||MOBILE_TIME_WIDTH[0])[0]}}]),MobileTimeLine}(BaseTimeLine);function isOverlap(a_start,a_end,b_start,b_end){return Math.max(a_start,b_start)<=Math.min(a_end,b_end)}function _create_class(Constructor,protoProps,staticProps){return protoProps&&function(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}(Constructor.prototype,protoProps),Constructor}function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _set_prototype_of(o,p){return _set_prototype_of=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_set_prototype_of(o,p)}var _$TIMELINE_DEFAULT_OPTIONS$_={height:36,dpr:window.devicePixelRatio||2,scaleOffsetTop:4,showYearMonthDay:!0},TimeLine=function(BaseTimeLine){function TimeLine(container,options){var _this;return(_this=BaseTimeLine.call(this,container,deepmerge(_$TIMELINE_DEFAULT_OPTIONS$_,options,{clone:!0}))||this)._$canvas=null,_this._ctx=null,_this._timeWidthArray=TIME_WIDTH[0],_this._centerPositionX=0,_this._isMouseDown=!1,_this._mousePosition=0,_this._oldTime=null,_this._isOver=!1,_this._moved=!1,_this._isCtrlKeyDown=!1,_this._lastTouchDist=0,_this.$container=container,_this._mousemoveFun=_this._mousemoveFun.bind(_this),_this._mouseoverFun=_this._mouseoverFun.bind(_this),_this._mouseleaveFun=_this._mouseleaveFun.bind(_this),_this._mousedownFun=_this._mousedownFun.bind(_this),_this._mouseUpFun=_this._mouseUpFun.bind(_this),_this._mousewheelFun=_this._mousewheelFun.bind(_this),_this._touchstartFun=_this._touchstartFun.bind(_this),_this._touchmoveFun=_this._touchmoveFun.bind(_this),_this._touchendFun=_this._touchendFun.bind(_this),_this._ctrlKeyDownFun=_this._ctrlKeyDownFun.bind(_this),_this._ctrlKeyUpFun=_this._ctrlKeyUpFun.bind(_this),_this._init(),_this}!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_set_prototype_of(subClass,superClass)}(TimeLine,BaseTimeLine);var _proto=TimeLine.prototype;return _proto._init=function(){this._$canvas=document.createElement("canvas"),this._ctx=this._$canvas.getContext("2d"),this.readOnly||(this._$canvas.style.cssText+="cursor: pointer;"),this.$container.appendChild(this._$canvas),this.resize(this.width,this.height),this._update({current:this.current,timeWidth:this.timeWidth,timeSections:this.timeSections}),this._addEventListener()},_proto.resize=function(width,height){BaseTimeLine.prototype.resize.call(this,width,height),this._$canvas&&width&&(this._$canvas.width=this.width*this.options.dpr,this._$canvas.style.cssText+="width: "+this.width+"px;"),this._$canvas&&height&&(this._$canvas.height=this.height*this.options.dpr,this._$canvas.style.cssText+="height: "+this.height+"px;"),this._draw()},_proto.setTimeWidth=function(timeWidth){this._update({timeWidth:timeWidth})},_proto.updateTimeSections=function(timeSections){this._update({timeSections:timeSections})},_proto.update=function(time){time&&!this._isMouseDown&&this._update({current:distExports$3.DateTime.toDate(time)})},_proto._update=function(options){var left,right,_this__$canvas;(void 0===options&&(options={}),(null==options?void 0:options.current)&&(left=options.current,null!=(right=Date)&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?right[Symbol.hasInstance](left):left instanceof right)&&(this.current=options.current),(null==options?void 0:options.timeSections)&&BaseTimeLine.prototype.updateTimeSections.call(this,this._mergeTimeSections(options.timeSections)),"number"==typeof(null==options?void 0:options.timeWidth)&&(null==options?void 0:options.timeWidth)<TIME_WIDTH.length&&(BaseTimeLine.prototype.setTimeWidth.call(this,options.timeWidth),this._timeWidthArray=TIME_WIDTH[Math.floor(this.timeWidth)]),"number"==typeof(null==options?void 0:options.timeWidth)&&this._timeWidthArray)&&(this._timeWidthArray[3]&&(null==(_this__$canvas=this._$canvas)||_this__$canvas.setAttribute("data-title",this._timeWidthArray[3])));this._draw()},_proto.setReadOnly=function(readOnly){BaseTimeLine.prototype.setReadOnly.call(this,readOnly),this._$canvas&&(this._$canvas.style.cssText+="cursor: "+(readOnly?"not-allowed":"pointer"))},_proto.destroy=function(){if(this._removeEventListener(),this._$canvas)try{this.$container.removeChild(this._$canvas),this._$canvas=null}catch(e){}BaseTimeLine.prototype.destroy.call(this)},_proto._draw=function(){this._ctx&&(this._ctx.fillStyle=this.options.timeAxisBgColor,this._ctx.fillRect(0,0,this.width*this.options.dpr,this.height*this.options.dpr)),this._drawSections(),this._drawScale()},_proto._drawScale=function(){var lineWidth=1*this.options.dpr;this._centerPositionX=parseInt(this.width*this.options.dpr/2+"");for(var centerPosition={x:this.width*this.options.dpr/2,y:this.height*this.options.dpr},curScaleTime=Math.floor(this.current.getTime()/1e3),offsetSecond=(curScaleTime-Math.floor(distExports$3.DateTime.toDate(distExports$3.DateTime.format(new Date(1e3*curScaleTime),"YYYY-MM-DD")).getTime()/1e3))%this._timeWidthArray[0],padding=this.height*this.options.dpr/20,spacing=this._curScaleSpacing*this.options.dpr,rightLastScaleTimeX=Math.floor(this._centerPositionX+(this._timeWidthArray[0]-offsetSecond)/this._timeWidthArray[0]*spacing),leftLastScaleTime=curScaleTime-offsetSecond,rightLastScaleTime=leftLastScaleTime+this._timeWidthArray[0],x=rightLastScaleTimeX-spacing;x>0;x-=spacing){0===(leftLastScaleTime-Math.floor(distExports$3.DateTime.toDate(distExports$3.DateTime.format(new Date(1e3*leftLastScaleTime),"YYYY-MM-DD")).getTime()/1e3))%(this._timeWidthArray[0]*this._timeWidthArray[2])?(this._drawSolidLine(x,padding,x,padding+(this.options.scaleOffsetTop+4)*this.options.dpr,lineWidth),this._drawTextString(distExports$3.DateTime.format(new Date(1e3*leftLastScaleTime),"YYYY-MM-DD HH:mm:ss"),x,padding+(this.options.scaleOffsetTop+4+4)*this.options.dpr,"center")):this._drawSolidLine(x,padding,x,padding+this.options.scaleOffsetTop*this.options.dpr,lineWidth),leftLastScaleTime-=this._timeWidthArray[0]}for(var x1=rightLastScaleTimeX;x1<=this.width*this.options.dpr;x1+=spacing){0===(rightLastScaleTime-Math.floor(distExports$3.DateTime.toDate(distExports$3.DateTime.format(new Date(1e3*rightLastScaleTime),"YYYY-MM-DD")).getTime()/1e3))%(this._timeWidthArray[0]*this._timeWidthArray[2])?(this._drawSolidLine(x1,padding,x1,padding+(this.options.scaleOffsetTop+4)*this.options.dpr,lineWidth),this._drawTextString(distExports$3.DateTime.format(new Date(1e3*rightLastScaleTime),"YYYY-MM-DD HH:mm:ss"),x1,padding+(this.options.scaleOffsetTop+4+4)*this.options.dpr,"center")):this._drawSolidLine(x1,padding,x1,padding+this.options.scaleOffsetTop*this.options.dpr,lineWidth),rightLastScaleTime+=this._timeWidthArray[0]}this._drawSolidLine(centerPosition.x,0,centerPosition.x,centerPosition.y,lineWidth,this.options.timePointColor)},_proto._drawSolidLine=function(startX,startY,endX,endY,lineWidth,color){this._ctx&&(this._ctx.save(),this._ctx.strokeStyle=null!=color?color:this.options.timeScaleColor,this._ctx.lineWidth=lineWidth,this._ctx.beginPath(),this._ctx.moveTo(startX,startY),this._ctx.lineTo(endX,endY),this._ctx.stroke(),this._ctx.restore())},_proto._drawTextString=function(text,x,y,align){if(this._ctx){var timeTexts=text.split(" ");this._ctx.font=12*this.options.dpr*1+"px serif",this._ctx.fillStyle=this.options.timeTextColor,this._ctx.textAlign=align||"left",this._timeWidthArray[0]%60==0&&(timeTexts[1]=timeTexts[1].replace(/:00$/,"")),this._ctx.fillText(timeTexts[1],x,y+8*this.options.dpr),!this.options.showYearMonthDay||"00:00:00"!==timeTexts[1]&&"00:00"!==timeTexts[1]&&this._timeWidthArray[0]*this._timeWidthArray[2]!==86400||(this._ctx.textAlign=align||"left",this._ctx.fillText(timeTexts[0],x,y+18*this.options.dpr))}},_proto._drawSections=function(){for(var timeArr=this.timeSections||[],i=0;i<timeArr.length;i++){var position=this._findPosition(timeArr[i]);this._ctx&&isOverlap(0,this.width*this.options.dpr,position.x1,position.x2)&&(this._ctx.fillStyle=this.options.timeSectionColor,this._ctx.fillRect(position.x1,0,position.x2-position.x1,this.height*this.options.dpr))}},_proto._findPosition=function(item){var x1=(parseInt((item.startTime-this.current.getTime())/1e3+"",10)/this._timeWidthArray[0]*this._curScaleSpacing+this.width/2)*this.options.dpr;return{x1:x1,x2:x1+parseInt((item.endTime-item.startTime)/1e3+"",10)/this._timeWidthArray[0]*this._curScaleSpacing*this.options.dpr}},_proto._mergeTimeSections=function(timeSections){if(0===timeSections.length)return timeSections;for(var merged=[(timeSections=timeSections.map(function(item){return 10===(item.startTime+"").length&&(item.startTime=1e3*item.startTime),10===(item.endTime+"").length&&(item.endTime=1e3*item.endTime),_extends({},item,{startTime:item.startTime,endTime:item.endTime})}))[0]],i=1;i<timeSections.length;i++){var prev=merged[merged.length-1],curr=timeSections[i];prev.endTime>=curr.startTime?prev.endTime=Math.max(prev.endTime,curr.endTime):merged.push(curr)}return merged},_proto._addEventListener=function(){this._$canvas&&(this._$canvas.addEventListener("mousemove",this._mousemoveFun),this._$canvas.addEventListener("mouseover",this._mouseoverFun),this._$canvas.addEventListener("mouseleave",this._mouseleaveFun),this._$canvas.addEventListener("mousedown",this._mousedownFun),this._$canvas.addEventListener("mouseup",this._mouseUpFun),this._$canvas.addEventListener("wheel",this._mousewheelFun),this.$container.addEventListener("wheel",function(e){e.preventDefault()},{passive:!1}),this._$canvas.addEventListener("keydown",this._ctrlKeyDownFun),this._$canvas.addEventListener("keyup",this._ctrlKeyUpFun),document.addEventListener("keydown",this._ctrlKeyDownFun,!1),document.addEventListener("keyup",this._ctrlKeyUpFun,!1),this._$canvas.addEventListener("touchstart",this._touchstartFun,{passive:!1}),this._$canvas.addEventListener("touchmove",this._touchmoveFun,{passive:!1}),this._$canvas.addEventListener("touchend",this._touchendFun,{passive:!1}))},_proto._removeEventListener=function(){this._$canvas&&(this._$canvas.removeEventListener("mousemove",this._mousemoveFun),this._$canvas.removeEventListener("mouseover",this._mouseoverFun),this._$canvas.removeEventListener("mouseleave",this._mouseleaveFun),this._$canvas.removeEventListener("mousedown",this._mousedownFun),this._$canvas.removeEventListener("mouseup",this._mouseUpFun),this._$canvas.removeEventListener("wheel",this._mousewheelFun),this._$canvas.removeEventListener("keydown",this._ctrlKeyDownFun),this._$canvas.removeEventListener("keyup",this._ctrlKeyUpFun),document.removeEventListener("keydown",this._ctrlKeyDownFun),document.removeEventListener("keyup",this._ctrlKeyUpFun),this._$canvas.removeEventListener("touchstart",this._touchstartFun),this._$canvas.removeEventListener("touchmove",this._touchmoveFun),this._$canvas.removeEventListener("touchend",this._touchendFun))},_proto._mousedownFun=function(e){this.readOnly||(this._isMouseDown=!0,this._mousePosition=e.pageX,this._oldTime=this.current,null==this.options.onDragStart||this.options.onDragStart.call(this.options,this.current))},_proto._mouseoverFun=function(){this.readOnly||(this._isOver=!0)},_proto._mouseleaveFun=function(e){this.readOnly||(this._isOver=!1,this._moveEndOrTouchEndFun(e))},_proto._mouseUpFun=function(e){this._moveEndOrTouchEndFun(e)},_proto._mousemoveFun=function(e){if(!this.readOnly)if(this._isMouseDown&&this._isOver)this._moveUpdateFun(e.pageX);else{var left=parseInt(this.$container.offsetLeft+"",10);this._mousePosition=e.pageX-left,this._update()}},_proto._mousewheelFun=function(e){e.preventDefault(),this.readOnly},_proto._ctrlKeyDownFun=function(e){(e.ctrlKey||"Control"===e.key)&&(this._isCtrlKeyDown=!0)},_proto._ctrlKeyUpFun=function(e){(e.ctrlKey||"Control"===e.key)&&(this._isCtrlKeyDown=!1)},_proto._getTouchDistance=function(touches){var touch1=touches[0],touch2=touches[1],dx=touch2.clientX-touch1.clientX,dy=touch2.clientY-touch1.clientY;return Math.sqrt(dx*dx+dy*dy)},_proto._touchstartFun=function(e){if(!this.readOnly)if(this._oldTime=this.current,this._isOver=!0,1===e.touches.length){var touch=e.touches[0];this._isMouseDown=!0,this._mousePosition=touch.clientX}else 2===e.touches.length&&(this._lastTouchDist=this._getTouchDistance(e.touches))},_proto._touchmoveFun=function(e){if(e.preventDefault(),e.stopPropagation(),!this.readOnly)if(1===e.touches.length){var touch=e.touches[0];this._moveUpdateFun(touch.clientX)}else if(2===e.touches.length){this._getTouchDistance(e.touches);this._lastTouchDist}},_proto._touchendFun=function(e){this.readOnly||this._moveEndOrTouchEndFun(e)},_proto._moveEndOrTouchEndFun=function(e){e.preventDefault(),this.readOnly||this._isMouseDown&&(this._isMouseDown=!1,this._moved&&(this._moved=!1,this._update({current:this.current}),this._oldTime=this.current,null==this.options.onDragEnd||this.options.onDragEnd.call(this.options,this.current,this._isOver)),this._isOver&&Math.abs(this._mousePosition-(e.pageX||0))>5&&(null==this.options.onChange||this.options.onChange.call(this.options,this.current)),this._mousePosition=0,this._lastTouchDist=0)},_proto._moveUpdateFun=function(x){var mouseOffset=this._mousePosition-x;if(0!==mouseOffset){if(this._oldTime){var currentTime=this._oldTime.getTime()+1e3*parseInt(mouseOffset/this._curScaleSpacing*this._timeWidthArray[0]+"",10);this._update({current:new Date(currentTime)}),null==this.options.onDragging||this.options.onDragging.call(this.options,new Date(currentTime))}this._moved=!0}},_create_class(TimeLine,[{key:"_curScaleSpacing",get:function(){var _this__timeWidthArray,_this__timeWidthArray1;return Math.floor((null==(_this__timeWidthArray=this._timeWidthArray)?void 0:_this__timeWidthArray[1])-(null==(_this__timeWidthArray1=this._timeWidthArray)?void 0:_this__timeWidthArray1[1])*+(this.timeWidth%1/2).toFixed(2))}}]),TimeLine}(BaseTimeLine);return TimeLine.TIME_WIDTH=TIME_WIDTH,distExports$3.isMobile()?MobileTimeLine:TimeLine});
